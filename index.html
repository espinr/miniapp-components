<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>MiniApp Components</title>
  <script async class="remove" src="https://www.w3.org/Tools/respec/respec-w3c"></script>
  <script class="remove">
    var respecConfig = {
      specStatus: "CG-DRAFT",
      copyrightStart: "2022",
      edDraftURI: "https://w3c.github.io/miniapp-components",
      editors: [
        {
          name: "Martin Alvarez-Espinar",
          companyURL: "https://www.huawei.com",
          company: "Huawei",
          w3cid: 125049,
        },
        {
          name: "Zitao Wang",
          companyURL: "https://www.huawei.com",
          company: "Huawei",
          w3cid: 124483,
        },
      ],
      group: "cg/miniapps",
      github: {
        repoURL: "https://github.com/w3c/miniapp-components",
        branch: "main",
      },
      localBiblio: {
      },
      a11y: true,
    };
  </script>
</head>

<body data-cite="MINIAPP-PACKAGING">

  <section id="abstract">
    <p>MiniApp Components are the building blocks to creating MiniApp Pages. These components encapsulate functionality, data,
      and styles, enabling developers to create custom and reusable items that can be combined to develop MiniApps. This
      specification aims to specify a set of common practices to define [=MiniApp Components=] that allow developers to build
      similar user interfaces across MiniApp platforms efficiently and provide a consistent user experience.</p>
  </section>

  <section id="sotd">
  </section>

  <section id="sec-introduction">
    <h2>Introduction</h2>

    <p>[=MiniApp Components=] are the building blocks to creating
      <a href="https://www.w3.org/TR/miniapp-packaging/#dfn-page"
        data-link-type="dfn">MiniApp Pages</a>. These components encapsulate functionality, data, and styles, enabling developers to create custom
        and reusable items that can be combined to develop MiniApps. MiniApps include essential elements like page containers,
        textual and multimedia content, and other interactive features like forms.</p>

    <p>To align MiniApps and Web applications, MiniApps may be defined using Web resources (i.e., HTML, CSS,
      and scripts) as described in [[MINIAPP-PACKAGING]]. Despite this, traditionally, MiniApp implementations offer specific
      non-standard features and mechanisms facilitating the development and implementation of the MiniApp Components.</p>

    <p>Although MiniApp Components share the same concept as Web Components, their capabilities and development features differ.
      The main differences are motivated by the architecture of the existing implementations along the MiniApp ecosystem
      following the MVVM pattern, based on components developed through domain-specific markup languages and without access
      to the standard DOM.</p>

    <p>To avoid overlap with Web Components, also supported by MiniApp user agents, this specification aims to be an informative
      reference and is not intended to be a formal standard. Thus, it aims to specify a set of common practices to define
      [=MiniApp Components=] that allow developers to build similar user interfaces across MiniApp platforms efficiently
      and provide a consistent user experience.</p>

    <section id="conformance">
    </section>
  </section>

  <section id="sec-basics">
    <h2>Component Basics</h2>
    <p></p>

    <section id="sec-pages-components">
      <h3>MiniApp Pages and Components</h3>
      <p>
        A <dfn>MiniApp Component</dfn> is a custom MiniApp element with encapsulated functionality, data and styles that
        can be reused in <a href="https://www.w3.org/TR/miniapp-packaging/#dfn-page" data-link-type="dfn">MiniApp Pages</a>.
      </p>
      <div class="ednote">
        Structure, differences with Web Pages and Web Components.
      </div>
    </section>

    <section id="sec-interface">
      <h3>MiniApp Interface</h3>
      <p>
      </p>
      <div class="ednote">
        Formal definition of the interface?
      </div>
    </section>
  </section>

  <section id="sec-templating">
    <h2>Templating</h2>
    <p></p>
    <section id="sec-data-interpolation">
      <h3>Content Interpolation</h3>
      <p></p>
      <div class="ednote">
        Data binding.
      </div>
    </section>
  </section>

  <section id="sec-declaration">
    <h2>Component Declaration</h2>
    <p></p>
    <div class="ednote">
      Component interface (properties)
    </div>
  </section>

  <section id="sec-reuse">
    <h2>Component Reuse</h2>
    <p></p>
    <div class="ednote">
      How to instantiate a component. Passing arguments, attributes. Access to component nodes.
    </div>
  </section>

  <section id="sec-properties">
    <h2>Component Properties and Methods</h2>
    <p></p>
    <div class="ednote">
    </div>
  </section>

  <section id="sec-events">
    <h2>Component Events</h2>
    <p>
      As defined in [[UIEVENTS]], an <a href="https://www.w3.org/TR/uievents/#event" data-link-type="dfn">event</a> is the representation of an occurrence (such as a mouse click on the presentation of an element, the removal of a child node from an element, or any number of other possibilities) that is associated with its <a href="https://www.w3.org/TR/uievents/#event-target" data-link-type="dfn">event target</a>. Each event is an instantiation of one specific <a href="https://www.w3.org/TR/uievents/#event-type" data-link-type="dfn">event type</a>.
    </p>
    <p>
      MiniApp user agents have a dual-thread architecture, decoupling the logic and rendering engines. Therefore, the logic layer does not have access to the complete DOM tree of the document in the rendering layer, and the event targets (nodes in the rendering layer) do not always support the <a href="https://dom.spec.whatwg.org/#introduction-to-dom-events">standard DOM Events</a> model as defined in [[DOM]]. MiniApp agents usually provide a customized event system to deal with events on the virtual DOM nodes.
    </p>
    <section id="sec-events-binding">
      <h3>Event Handlers</h3>
      <p>
        Elements in components can have event handlers specified. An event handler is composed of a value, usually an internal reference, and a listener, a callback function responsible for processing the algorithm for that event handler. In MiniApp components, the event handlers are exposed using event handler content attributes. These handlers are exposed through a name that starts with a specific keyword (`on`, `bind`, or others), followed by the event type identifier.
      </p>
      <pre class="example"><code>&lt;!-- my-component.html --&gt;
  &lt;text onclick="loadMore"&gt;example&lt;/text&gt; 
    &lt;!-- or --&gt;
  &lt;view bindtap="loadMore"&gt;example&lt;/view&gt;
</code></pre>
      <p data-cite="DOM">
        Due to the decoupled architecture, MiniApp elements do not implement the {{EventTarget}} interface, so they do not implement the {{EventTarget/addEventListener()}} function. Therefore, event binding is only performed statically using handler content attributes on the component elements. The callback function associated with the event handler is specified in the scripting resource in scope, as a member of the exported anonymous object.
      </p> 
      <pre class="example"><code>// my-component.js

  export default {
    loadMore(event) {
      console.log(event);
    }
  }
      </code></pre>
      <p>
        Likewise, developers can also define the callback functions to process the <a href="#sec-lifecycle">lifecycle events</a>.
      </p>
      <pre class="example"><code>// my-component.js

  export default {
    oncreated() {
      console.log('Component created!');
    },
    onready() {
      console.log('Component is ready!');
    }
  }
</code></pre>
    </section>
    <section id="sec-events-types">
      <h3>Types of Events</h3>
      <p>
        MiniApp user agents implement support for a common set of event handlers supported by all their component elements, similar to HTML. However,  MiniApps have been traditionally implemented in native environments, not focused on the Web, so the names of the types might vary. Also, MiniApps user agents usually implement different event types by default.
      </p>
      <p>
        The following list contains the handlers event types, supported by all MiniApp component elements:  
      </p>
      <dl>
        <dt>`touchstart`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchstart" data-link-type="dfn">touchstart</a> event type defined in [[TOUCH-EVENTS]], this event is dispatched on the topmost component (event target) indicated by the pointer when the user places a <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> on the touch surface.</dd>
        <dt>`touchmove`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchmove" data-link-type="dfn">touchmove</a> event type defined in [[TOUCH-EVENTS]], this event is dispatched on the topmost component (event target) indicated by the pointer when the user moves a <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> along the touch surface.</dd>
        <dt>`touchcancel`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchcancel" data-link-type="dfn">touchcancel</a> event type defined in [[TOUCH-EVENTS]], this event is dispatched on the topmost component (event target) indicated by the pointer when the <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> has been disrupted in an implementation-specific manner.</dd>
        <dt>`touchend`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/touch-events/#dfn-touchend" data-link-type="dfn">touchend</a> event type defined in [[TOUCH-EVENTS]], this event is  dispatched on the topmost component (event target) indicated by the pointer when the user removes a <a data-link-type="dfn" href="https://w3c.github.io/touch-events/#dfn-touch-point">touch point</a> from the touch surface, also including cases where the touch point physically leaves the touch surface.</dd>
        <dt>`click` or `tap`</dt>
        <dd>Like the <a href="https://www.w3.org/TR/uievents/#event-type-click" data-link-type="dfn">click</a></th> event type defined in [[UIEVENTS]], this event is dispatched on the topmost event target indicated by the pointer when the user presses down and releases the primary pointer button or otherwise activates the pointer in a manner that simulates such an action.</dd>
        <dt>`longtap` or `longpress`</dt>
        <dd>The `longpress` or `longtap` event type is dispatched on the topmost component (event target) indicated by the pointer when the user presses down, holds for at least (<mark>@@@ms@@@</mark>), and releases the primary pointer button or otherwise activates the pointer in a manner that simulates such an action.</dd>
      </dl>
      <div class="ednote">
        Could we define the minimum period to be considered as a long press?
      </div>      
    </section>
  </section>

  <section id="sec-scripting">
    <h2>Scripting Resources</h2>
    <p></p>
    <div class="ednote">
      Restrictions in the scripting resources.
    </div>
  </section>

  <section id="sec-stylesheets">
    <h2>Stylesheets</h2>
    <p></p>
    <div class="ednote">
      CSS profile supported.
    </div>
  </section>

  <section id="sec-lifecycle">
    <h2>Component Lifecycle</h2>
    <p></p>
    <div class="ednote">
      Explanation and links to MINIAPP-LIFECYCLE.
    </div>
  </section>

  <section id="sec-elements">
    <h2>MiniApp Elements</h2>
    <p></p>
    <div class="ednote">
      Essential MiniApp elements. List, global attributes, events...
    </div>
  </section>  

  <section id="sec-accessibility" class="informative">
    <h2>Accessibility Considerations</h2>
    <p></p>
  </section>

  <section id="sec-security" data-cite="PERMISSIONS">
    <h2>Security Considerations</h2>
    <p></p>
  </section>

  <section id="sec-privacy">
    <h2>Privacy Considerations</h2>
    <p></p>
  </section>

  <section class="appendix" id="sec-acknowledgments">
    <h2>Acknowledgments</h2>
    <div class="ednote">List all the contributors and W3C Team contacts</div>
  </section>

</body>

</html>